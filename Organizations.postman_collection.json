{
	"info": {
		"_postman_id": "org-crud-collection",
		"name": "Organization CRUD Operations",
		"description": "Complete CRUD operations for Organization endpoints",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "1. Create Organization (Minimal)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 201\", function () {",
							"    pm.response.to.have.status(201);",
							"});",
							"",
							"pm.test(\"Response has success: true\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.success).to.be.true;",
							"});",
							"",
							"pm.test(\"Save orgId for later use\", function () {",
							"    var jsonData = pm.response.json();",
							"    if (jsonData.data && jsonData.data.orgId) {",
							"        pm.environment.set(\"org_doc_id\", jsonData.data.orgId);",
							"        pm.environment.set(\"org_id\", jsonData.data.organizationId);",
							"    }",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"name\": \"Test Organization\",\n  \"org_id\": \"TEST-ORG-{{$randomInt}}\"\n}"
				},
				"url": {
					"raw": "{{base_url}}/api/organizations",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations"
					]
				}
			},
			"response": []
		},
		{
			"name": "2. Create Organization (Full)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 201\", function () {",
							"    pm.response.to.have.status(201);",
							"});",
							"",
							"pm.test(\"Save orgId for later use\", function () {",
							"    var jsonData = pm.response.json();",
							"    if (jsonData.data && jsonData.data.orgId) {",
							"        pm.environment.set(\"org_doc_id\", jsonData.data.orgId);",
							"        pm.environment.set(\"org_id\", jsonData.data.organizationId);",
							"    }",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"name\": \"Greater Southern Tier Transportation Services\",\n  \"org_id\": \"GST-TRANS-{{$randomInt}}\",\n  \"address\": \"123 Main Street\",\n  \"email\": \"info{{$randomInt}}@gsttransport.org\",\n  \"short_name\": \"GST Transport\",\n  \"phone_number\": \"607-555-0100\",\n  \"lisence_number\": \"NY-12345\",\n  \"website\": \"https://www.gsttransport.org\",\n  \"address2\": \"Suite 100\",\n  \"city\": \"Elmira\",\n  \"state\": \"NY\",\n  \"zip\": \"14901\",\n  \"pc_name\": \"John Smith\",\n  \"pc_phone_number\": \"607-555-0101\",\n  \"pc_email\": \"john.smith@gsttransport.org\",\n  \"pc_address\": \"123 Main Street\",\n  \"pc_address2\": \"Suite 100\",\n  \"pc_city\": \"Elmira\",\n  \"pc_state\": \"NY\",\n  \"pc_zip\": \"14901\",\n  \"sc_name\": \"Jane Doe\",\n  \"sc_phone_number\": \"607-555-0102\",\n  \"sc_email\": \"jane.doe@gsttransport.org\",\n  \"sc_address\": \"123 Main Street\",\n  \"sc_address2\": \"Suite 100\",\n  \"sc_city\": \"Elmira\",\n  \"sc_state\": \"NY\",\n  \"sc_zip\": \"14901\",\n  \"sys_admin_phone_number\": \"607-555-0103\",\n  \"sys_admin_user_id\": \"admin-user-001\",\n  \"sys_admin_security_level\": \"Super Admin\"\n}"
				},
				"url": {
					"raw": "{{base_url}}/api/organizations",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations"
					]
				}
			},
			"response": []
		},
		{
			"name": "3. Get All Organizations",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Response has organizations array\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData).to.have.property('organizations');",
							"    pm.expect(jsonData.organizations).to.be.an('array');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/api/organizations",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations"
					]
				}
			},
			"response": []
		},
		{
			"name": "4. Get Organization by Document ID",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Organization contains required fields\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.organization).to.have.property('name');",
							"    pm.expect(jsonData.organization).to.have.property('org_id');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/api/organizations/{{org_doc_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations",
						"{{org_doc_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "5. Get Organization by org_id",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Organization contains all schema fields\", function () {",
							"    var jsonData = pm.response.json();",
							"    var org = jsonData.organization;",
							"    pm.expect(org).to.have.property('name');",
							"    pm.expect(org).to.have.property('org_id');",
							"    pm.expect(org).to.have.property('email');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/api/organizations/{{org_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations",
						"{{org_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "6. Update Organization (Contact Info)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Updated field matches request\", function () {",
							"    var jsonData = pm.response.json();",
							"    var requestBody = JSON.parse(pm.request.body.raw);",
							"    if (requestBody.phone_number) {",
							"        pm.expect(jsonData.organization.phone_number).to.eql(requestBody.phone_number);",
							"    }",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"phone_number\": \"607-555-9999\",\n  \"email\": \"updated{{$randomInt}}@gsttransport.org\"\n}"
				},
				"url": {
					"raw": "{{base_url}}/api/organizations/{{org_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations",
						"{{org_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "7. Update Organization (Primary Contact)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Primary contact fields updated\", function () {",
							"    var jsonData = pm.response.json();",
							"    var requestBody = JSON.parse(pm.request.body.raw);",
							"    if (requestBody.pc_name) {",
							"        pm.expect(jsonData.organization.pc_name).to.eql(requestBody.pc_name);",
							"    }",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"pc_name\": \"John Smith Updated\",\n  \"pc_email\": \"john.updated@gsttransport.org\",\n  \"pc_phone_number\": \"607-555-0200\"\n}"
				},
				"url": {
					"raw": "{{base_url}}/api/organizations/{{org_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations",
						"{{org_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "8. Update Organization (Address)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "PUT",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"address\": \"456 New Street\",\n  \"address2\": \"Suite 200\",\n  \"city\": \"Corning\",\n  \"state\": \"NY\",\n  \"zip\": \"14830\"\n}"
				},
				"url": {
					"raw": "{{base_url}}/api/organizations/{{org_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations",
						"{{org_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "9. Delete Organization",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Response contains deleted organization\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData).to.have.property('deletedOrganization');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "DELETE",
				"header": [],
				"url": {
					"raw": "{{base_url}}/api/organizations/{{org_id}}",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations",
						"{{org_id}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "10. Error Test - Create Duplicate org_id",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 409 Conflict\", function () {",
							"    pm.response.to.have.status(409);",
							"});",
							"",
							"pm.test(\"Error message indicates duplicate\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.message).to.include('already exists');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"name\": \"Duplicate Test\",\n  \"org_id\": \"{{org_id}}\"\n}"
				},
				"url": {
					"raw": "{{base_url}}/api/organizations",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations"
					]
				}
			},
			"response": []
		},
		{
			"name": "11. Error Test - Get Non-existent Organization",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 404\", function () {",
							"    pm.response.to.have.status(404);",
							"});",
							"",
							"pm.test(\"Error message indicates not found\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.message).to.include('not found');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/api/organizations/non-existent-id-12345",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations",
						"non-existent-id-12345"
					]
				}
			},
			"response": []
		},
		{
			"name": "12. Error Test - Create Without Required Fields",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 400\", function () {",
							"    pm.response.to.have.status(400);",
							"});",
							"",
							"pm.test(\"Error message indicates missing fields\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.message).to.include('Missing required fields');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"email\": \"test@example.com\"\n}"
				},
				"url": {
					"raw": "{{base_url}}/api/organizations",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"api",
						"organizations"
					]
				}
			},
			"response": []
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:3000",
			"type": "string"
		}
	]
}

